package com.flightapp.inventoryservice.kafka;

import java.util.List;

import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Component;

import com.flightapp.commonmodule.utility.JsonUtil;
import com.flightapp.inventoryservice.dto.InventoryRequest;

@Component
public class InventoryKafkaConsumer {

	@KafkaListener(topics = "inventory-service", groupId = "group_id")
	public void consume(List<ConsumerRecord<String,String>> records) {
		for(ConsumerRecord<String,String> record:records) {
			InventoryRequest request = JsonUtil.toObject(record.value(), InventoryRequest.class);
			
			//System.out.println("message = " + message);
		}
	}

}
